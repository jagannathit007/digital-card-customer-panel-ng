<div class="tw-p-4">
  <!-- Header and Add Idea Button -->
  <div class="tw-flex tw-justify-between tw-items-center tw-mb-6">
    <div>
      <h2 class="tw-text-2xl tw-font-bold tw-text-gray-800">Idea Board</h2>
      <p class="tw-text-sm tw-text-gray-500">
        Capture and organize your creative ideas
      </p>
    </div>
    <div class="tw-flex tw-gap-2">
      <button
        class="tw-bg-gray-600 hover:tw-bg-gray-700 tw-text-white tw-px-4 tw-py-2 tw-rounded-lg tw-flex tw-items-center tw-shadow-sm"
        (click)="openCategoryModal()"
      >
        <i class="ri-folder-line tw-mr-2"></i> Manage Categories
      </button>
      <button
        class="tw-bg-blue-600 hover:tw-bg-blue-700 tw-text-white tw-px-4 tw-py-2 tw-rounded-lg tw-flex tw-items-center tw-shadow-sm"
        (click)="openIdeaModal()"
      >
        <i class="ri-add-line tw-mr-2"></i> Add Idea
      </button>
    </div>
  </div>

  <!-- Search and Filter Section -->
  <div
    class="tw-bg-white tw-rounded-lg tw-shadow tw-p-4 tw-mb-6 tw-border tw-border-gray-100"
  >
    <div class="tw-flex tw-flex-wrap tw-items-center tw-gap-4">
      <div class="tw-flex-1 tw-min-w-[250px]">
        <label
          class="tw-block tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-1"
          >Search Ideas</label
        >
        <div class="tw-relative">
          <input
            type="text"
            class="tw-w-full tw-pl-10 tw-pr-4 tw-py-2 tw-border tw-border-gray-300 tw-rounded-lg focus:tw-ring-2 focus:tw-ring-blue-500 focus:tw-border-blue-500 tw-transition-all"
            [(ngModel)]="searchText"
            (ngModelChange)="onSearch()"
            placeholder="Search by title, description..."
          />
          <div
            class="tw-absolute tw-inset-y-0 tw-left-0 tw-pl-3 tw-flex tw-items-center tw-pointer-events-none"
          >
            <i class="ri-search-line tw-text-gray-400"></i>
          </div>
        </div>
      </div>
      <div class="tw-min-w-[200px]">
        <label
          class="tw-block tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-1"
          >Category Filter</label
        >
        <select
          class="tw-w-full tw-px-3 tw-py-2 tw-border tw-border-gray-300 tw-rounded-lg focus:tw-ring-2 focus:tw-ring-blue-500 focus:tw-border-blue-500 tw-transition-all"
          [(ngModel)]="categoryFilter"
          (ngModelChange)="onFilterChange()"
        >
          <option value="all">All Categories</option>
          <option *ngFor="let category of categories" [value]="category">
            {{ category }}
          </option>
        </select>
      </div>
      <div class="tw-min-w-[200px]">
        <label
          class="tw-block tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-1"
          >Color Filter</label
        >
        <select
          class="tw-w-full tw-px-3 tw-py-2 tw-border tw-border-gray-300 tw-rounded-lg focus:tw-ring-2 focus:tw-ring-blue-500 focus:tw-border-blue-500 tw-transition-all"
          [(ngModel)]="colorFilter"
          (ngModelChange)="onFilterChange()"
        >
          <option value="all">All Colors</option>
          <option *ngFor="let color of colorOptions" [value]="color.value">
            {{ color.name }}
          </option>
        </select>
      </div>
    </div>
  </div>

  <!-- Ideas Grid -->
  <div class="tw-p-4 tw-mb-6 tw-border tw-border-gray-100">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="tw-p-8 tw-text-center">
      <div
        class="tw-inline-block tw-animate-spin tw-rounded-full tw-h-8 tw-w-8 tw-border-t-2 tw-border-b-2 tw-border-blue-500 tw-mb-2"
      ></div>
      <p class="tw-text-gray-600">Loading ideas...</p>
    </div>

    <!-- Empty State -->
    <div
      *ngIf="!isLoading && filteredIdeas.length === 0"
      class="tw-p-8 tw-text-center"
    >
      <div
        class="tw-inline-flex tw-items-center tw-justify-center tw-w-16 tw-h-16 tw-rounded-full tw-bg-blue-50 tw-mb-4"
      >
        <i class="ri-lightbulb-flash-line tw-text-2xl tw-text-blue-600"></i>
      </div>
      <h3 class="tw-text-lg tw-font-medium tw-text-gray-900 tw-mb-1">
        No Ideas Found
      </h3>
      <p class="tw-text-gray-500 tw-mb-4">
        Try adjusting your search or add a new idea
      </p>
      <button
        class="tw-bg-blue-600 hover:tw-bg-blue-700 tw-text-white tw-px-4 tw-py-2 tw-rounded-lg tw-shadow-sm tw-transition-colors"
        (click)="openIdeaModal()"
      >
        <i class="ri-add-line tw-mr-2"></i> Add Idea
      </button>
    </div>

    <!-- Ideas Grid -->
    <div
      *ngIf="!isLoading && filteredIdeas.length > 0"
      class="tw-grid tw-grid-cols-1 sm:tw-grid-cols-2 lg:tw-grid-cols-4 tw-gap-4"
    >
      <div
        *ngFor="let idea of filteredIdeas"
        class="tw-rounded-lg tw-shadow-md tw-overflow-hidden tw-transition-transform hover:tw-scale-105"
        [style.background]="idea.color"
      >
        <div class="tw-p-4 tw-h-full tw-flex tw-flex-col">
          <!-- Idea Header -->
          <div class="tw-flex tw-justify-between tw-items-start tw-mb-2">
            <h3 class="tw-text-lg tw-font-semibold tw-text-gray-900">
              {{ idea.title }}
            </h3>
            <div class="tw-flex tw-gap-1">
              <button
                class="tw-p-1 tw-text-gray-700 hover:tw-bg-white/30 tw-rounded-full tw-transition-colors"
                (click)="onEditIdea(idea)"
                title="Edit Idea"
              >
                <i class="ri-edit-line"></i>
              </button>
              <button
                class="tw-p-1 tw-text-gray-700 hover:tw-bg-white/30 tw-rounded-full tw-transition-colors"
                (click)="onDeleteIdea(idea._id)"
                title="Delete Idea"
              >
                <i class="ri-delete-bin-line"></i>
              </button>
            </div>
          </div>

          <!-- Category Badge -->
          <div class="tw-mb-3">
            <span
              class="tw-inline-block tw-bg-white/30 tw-text-xs tw-font-medium tw-px-2 tw-py-1 tw-rounded-full"
            >
              {{ idea.category }}
            </span>
          </div>

          <!-- Description -->
          <div class="tw-flex-1 tw-mb-4">
            <p class="tw-text-gray-900 tw-text-sm">{{ idea.description }}</p>
          </div>

          <!-- Footer -->
          <div
            class="tw-flex tw-justify-between tw-items-center tw-text-xs tw-text-gray-800"
          >
            <span>{{ idea.createdAt | date : "mediumDate" }}</span>
            <div class="tw-flex tw-items-center">
              <div
                class="tw-w-3 tw-h-3 tw-rounded-full tw-mr-1"
                [style.background]="getColorName(idea.color)"
              ></div>
              <span>{{ getColorName(idea.color) }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Category Management Modal -->
<div
  class="modal fade"
  id="categoryFormModal"
  tabindex="-1"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  role="dialog"
>
  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div
      class="modal-content tw-border-0 tw-shadow-xl tw-rounded-xl tw-overflow-hidden"
    >
      <!-- Modal Header -->
      <div class="modal-header tw-bg-green-50 tw-border-b tw-p-4">
        <div class="tw-flex tw-items-center">
          <div
            class="tw-bg-green-500 tw-rounded-full tw-p-2 tw-mr-3 tw-shadow-sm"
          >
            <i class="ri-folder-line tw-text-white"></i>
          </div>
          <h5 class="modal-title tw-font-semibold tw-text-gray-800 tw-mb-0">
            Manage Categories
          </h5>
        </div>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
          (click)="onResetCategory()"
        ></button>
      </div>

      <div class="modal-body tw-p-4">
        <!-- Add New Category Form -->
        <div class="tw-bg-gray-50 tw-p-4 tw-rounded-lg tw-mb-6">
          <h6 class="tw-font-medium tw-text-gray-800 tw-mb-3">
            Add New Category
          </h6>
          <form (ngSubmit)="onSaveCategory()" class="tw-flex tw-gap-3">
            <input
              type="text"
              class="tw-flex-1 tw-px-3 tw-py-2 tw-border tw-border-gray-300 tw-rounded-lg focus:tw-ring-2 focus:tw-ring-green-500 focus:tw-border-green-500"
              [(ngModel)]="categoryForm.name"
              [ngModelOptions]="{ standalone: true }"
              placeholder="Enter category name"
              required
            />
            <button
              type="submit"
              class="tw-bg-green-600 hover:tw-bg-green-700 tw-text-white tw-px-4 tw-py-2 tw-rounded-lg tw-text-sm"
              [disabled]="isSavingCategory"
            >
              {{ isSavingCategory ? "Adding..." : "Add Category" }}
            </button>
          </form>
        </div>

        <!-- Categories List -->
        <div>
          <h6 class="tw-font-medium tw-text-gray-800 tw-mb-3">
            Existing Categories
          </h6>

          <!-- Loading State -->
          <div *ngIf="isLoadingCategories" class="tw-p-4 tw-text-center">
            <div
              class="tw-inline-block tw-animate-spin tw-rounded-full tw-h-6 tw-w-6 tw-border-t-2 tw-border-b-2 tw-border-green-500"
            ></div>
            <p class="tw-text-gray-600 tw-mt-2">Loading categories...</p>
          </div>

          <!-- Empty State -->
          <div
            *ngIf="!isLoadingCategories && categoryList.length === 0"
            class="tw-p-4 tw-text-center tw-text-gray-500"
          >
            <i class="ri-folder-line tw-text-2xl tw-mb-2"></i>
            <p>No categories found. Add your first category above.</p>
          </div>

          <!-- Categories List -->
          <div
            *ngIf="!isLoadingCategories && categoryList.length > 0"
            class="tw-space-y-2"
          >
            <div
              *ngFor="let category of categoryList"
              class="tw-flex tw-items-center tw-justify-between tw-p-3 tw-bg-white tw-border tw-border-gray-200 tw-rounded-lg"
            >
              <div class="tw-flex tw-items-center tw-gap-3">
                <i class="ri-folder-line tw-text-green-600"></i>
                <span class="tw-font-medium">{{ category.name }}</span>
                <!-- <span class="tw-text-xs tw-text-gray-500">({{ category.ideaCount || 0 }} ideas)</span> -->
              </div>
              <div class="tw-flex tw-gap-2">
                <button
                  class="tw-p-1 tw-text-blue-600 hover:tw-bg-blue-50 tw-rounded tw-transition-colors"
                  (click)="onEditCategory(category)"
                  title="Edit Category"
                >
                  <i class="ri-edit-line"></i>
                </button>
                <button
                  class="tw-p-1 tw-text-red-600 hover:tw-bg-red-50 tw-rounded tw-transition-colors"
                  (click)="onDeleteCategory(category._id)"
                  title="Delete Category"
                >
                  <i class="ri-delete-bin-line"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Edit Category Modal -->
<div
  class="modal fade"
  id="editCategoryModal"
  tabindex="-1"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  role="dialog"
>
  <div class="modal-dialog modal-dialog-centered modal-md" role="document">
    <div
      class="modal-content tw-border-0 tw-shadow-xl tw-rounded-xl tw-overflow-hidden"
    >
      <!-- Modal Header -->
      <div class="modal-header tw-bg-blue-50 tw-border-b tw-p-4">
        <div class="tw-flex tw-items-center">
          <div
            class="tw-bg-blue-500 tw-rounded-full tw-p-2 tw-mr-3 tw-shadow-sm"
          >
            <i class="ri-edit-line tw-text-white"></i>
          </div>
          <h5 class="modal-title tw-font-semibold tw-text-gray-800 tw-mb-0">
            Edit Category
          </h5>
        </div>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
          (click)="onResetEditCategory()"
        ></button>
      </div>

      <div class="modal-body tw-p-4">
        <form (ngSubmit)="onUpdateCategory()" class="tw-space-y-4">
          <div>
            <label
              class="tw-block tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-1"
              >Category Name*</label
            >
            <input
              type="text"
              class="tw-w-full tw-px-3 tw-py-2 tw-border tw-border-gray-300 tw-rounded-lg focus:tw-ring-2 focus:tw-ring-blue-500 focus:tw-border-blue-500"
              [(ngModel)]="editCategoryForm.name"
              [ngModelOptions]="{ standalone: true }"
              placeholder="Enter category name"
              required
            />
          </div>

          <div class="tw-flex tw-justify-end tw-gap-2 tw-pt-2">
            <button
              type="button"
              class="tw-bg-gray-100 hover:tw-bg-gray-200 tw-text-gray-700 tw-px-4 tw-py-2 tw-rounded-lg tw-text-sm"
              (click)="onResetEditCategory()"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="tw-bg-blue-600 hover:tw-bg-blue-700 tw-text-white tw-px-4 tw-py-2 tw-rounded-lg tw-text-sm"
              [disabled]="isSavingCategory"
            >
              {{ isSavingCategory ? "Updating..." : "Update Category" }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Idea Form Modal -->
<div
  class="modal fade"
  id="ideaFormModal"
  tabindex="-1"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  role="dialog"
>
  <div class="modal-dialog modal-dialog-centered modal-md" role="document">
    <div
      class="modal-content tw-border-0 tw-shadow-xl tw-rounded-xl tw-overflow-hidden"
    >
      <!-- Modal Header -->
      <div class="modal-header tw-bg-blue-50 tw-border-b tw-p-4">
        <div class="tw-flex tw-items-center">
          <div
            class="tw-bg-blue-500 tw-rounded-full tw-p-2 tw-mr-3 tw-shadow-sm"
          >
            <i class="ri-lightbulb-line tw-text-white"></i>
          </div>
          <h5 class="modal-title tw-font-semibold tw-text-gray-800 tw-mb-0">
            {{ isEditMode ? "Edit Idea" : "New Idea" }}
          </h5>
        </div>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
          (click)="onResetAndClose()"
        ></button>
      </div>

      <div class="modal-body tw-p-4">
        <form (ngSubmit)="onSaveIdea()" class="tw-space-y-4">
          <!-- Title Field -->
          <div>
            <label
              class="tw-block tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-1"
              >Title*</label
            >
            <input
              type="text"
              class="tw-w-full tw-px-3 tw-py-2 tw-border tw-border-gray-300 tw-rounded-lg focus:tw-ring-2 focus:tw-ring-blue-500 focus:tw-border-blue-500"
              [(ngModel)]="form.idea.title"
              [ngModelOptions]="{ standalone: true }"
              placeholder="Idea title"
              required
            />
          </div>

          <!-- Description Field -->
          <div>
            <label
              class="tw-block tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-1"
              >Description*</label
            >
            <textarea
              rows="2"
              class="tw-w-full tw-px-3 tw-py-2 tw-border tw-border-gray-300 tw-rounded-lg focus:tw-ring-2 focus:tw-ring-blue-500 focus:tw-border-blue-500"
              [(ngModel)]="form.idea.description"
              [ngModelOptions]="{ standalone: true }"
              placeholder="Brief description"
              required
            ></textarea>
          </div>

          <!-- Category Field -->
          <div>
            <label
              class="tw-block tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-1"
              >Category*</label
            >
            <select
              class="tw-w-full tw-px-3 tw-py-2 tw-border tw-border-gray-300 tw-rounded-lg focus:tw-ring-2 focus:tw-ring-blue-500 focus:tw-border-blue-500"
              [(ngModel)]="form.idea.categoryId"
              [ngModelOptions]="{ standalone: true }"
              required
            >
              <option value="">Select category</option>
              <option
                *ngFor="let category of categoryList"
                [value]="category._id"
              >
                {{ category.name }}
              </option>
            </select>
          </div>

          <!-- Color Selection -->
          <div>
            <label
              class="tw-block tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-2"
              >Color</label
            >
            <div class="tw-flex tw-items-center">
              <div
                *ngFor="let color of colorOptions"
                class="tw-relative ms-2 tw-group"
                (click)="form.idea.color = color.value"
              >
                <div
                  class="tw-w-8 tw-h-8 tw-rounded-full tw-border-2 tw-cursor-pointer tw-transition-all"
                  [style.background]="color.value"
                  [class.tw-scale-110]="form.idea.color === color.value"
                  [class.tw-border-blue-500]="form.idea.color === color.value"
                  [class.tw-border-gray-300]="form.idea.color !== color.value"
                >
                  <div
                    class="tw-absolute tw-inset-0 tw-flex tw-items-center tw-justify-center"
                    *ngIf="form.idea.color === color.value"
                  >
                    <i class="ri-check-line tw-text-white tw-text-xs"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="tw-flex tw-justify-end tw-gap-2 tw-pt-2">
            <button
              type="button"
              class="tw-bg-gray-100 hover:tw-bg-gray-200 tw-text-gray-700 tw-px-4 tw-py-2 tw-rounded-lg tw-text-sm"
              (click)="onResetAndClose()"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="tw-bg-blue-600 hover:tw-bg-blue-700 tw-text-white tw-px-4 tw-py-2 tw-rounded-lg tw-text-sm"
              [disabled]="isSaving"
            >
              {{ isSaving ? "Saving..." : "Save" }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
